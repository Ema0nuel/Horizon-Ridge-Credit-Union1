import{u as Q,c as Z,r as d,j as e,a as C,s as S}from"./index-nw5vX4eR.js";import{i as ee}from"./adminAuth-Cqntgn8B.js";import{H as O,S as P}from"./SideBar-Dzs2tQP8.js";const B=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),z=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),q=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),$=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),R=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),X=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),te=()=>e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),se=()=>e.jsx("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),u=({label:r,name:o,type:p="text",value:l,onChange:s,placeholder:x,disabled:i=!1,error:b,required:t=!1,readonly:g=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:[r,t&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsx("input",{type:p,name:o,value:l,onChange:s,placeholder:x,disabled:i||g,readOnly:g,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans text-sm ${b?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${i||g?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`}),b&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:b})]}),w=({label:r,name:o,value:p,onChange:l,options:s,disabled:x=!1,error:i,required:b=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:[r,b&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsxs("select",{name:o,value:p,onChange:l,disabled:x,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans text-sm ${i?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${x?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`,children:[e.jsxs("option",{value:"",children:["Select ",r.toLowerCase()]}),s.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),i&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:i})]}),ae=({account:r,onClose:o,onSubmit:p,submitting:l})=>{const[s,x]=d.useState({account_number:r?.account_number||"",account_type:r?.account_type||"checking",currency:r?.currency||"USD",balance:r?.balance||0,available_balance:r?.available_balance||0,status:r?.status||"active",overdraft_limit:r?.overdraft_limit||0,daily_transaction_limit:r?.daily_transaction_limit||1e4,monthly_transaction_limit:r?.monthly_transaction_limit||1e5,created_at:r?.created_at?new Date(r.created_at).toISOString().slice(0,16):""}),[i,b]=d.useState({}),t=n=>{const{name:m,value:h}=n.target;x(f=>({...f,[m]:m.includes("limit")||m.includes("balance")?parseFloat(h)||0:h})),i[m]&&b(f=>({...f,[m]:""}))},g=()=>{const n={};return s.account_number||(n.account_number="Account number is required"),s.balance<0&&(n.balance="Balance cannot be negative"),s.available_balance<0&&(n.available_balance="Available balance cannot be negative"),n},v=n=>{n.preventDefault();const m=g();if(Object.keys(m).length>0){b(m);return}const h=s.created_at?new Date(s.created_at).toISOString():r?.created_at;p({account_number:s.account_number,account_type:s.account_type,currency:s.currency,balance:s.balance,available_balance:s.available_balance,status:s.status,overdraft_limit:s.overdraft_limit,daily_transaction_limit:s.daily_transaction_limit,monthly_transaction_limit:s.monthly_transaction_limit,created_at:h})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary",children:"âœï¸ Edit Account"}),e.jsx("button",{onClick:o,disabled:l,className:"text-secondary opacity-60 hover:opacity-100 transition-all",children:e.jsx($,{})})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(u,{label:"Account Number",name:"account_number",value:s.account_number,onChange:t,disabled:!0,error:i.account_number}),e.jsx(w,{label:"Account Type",name:"account_type",value:s.account_type,onChange:t,options:[{value:"checking",label:"Checking"},{value:"savings",label:"Savings"},{value:"money_market",label:"Money Market"}]}),e.jsx(w,{label:"Currency",name:"currency",value:s.currency,onChange:t,options:[{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"},{value:"CAD",label:"CAD"}]}),e.jsx(w,{label:"Status",name:"status",value:s.status,onChange:t,options:[{value:"active",label:"Active"},{value:"frozen",label:"Frozen"},{value:"closed",label:"Closed"},{value:"suspended",label:"Suspended"}]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"ðŸ“… Account Dates"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(u,{label:"Account Created Date",name:"created_at",type:"datetime-local",value:s.created_at,onChange:t,error:i.created_at}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:"Current Value (UTC)"}),e.jsx("div",{className:"px-4 py-3 border border-secondary rounded-sm bg-gray-50 text-secondary text-sm font-mono",children:r?.created_at?new Date(r.created_at).toISOString():"N/A"})]})]}),e.jsx("p",{className:"text-xs text-secondary opacity-60 mt-2",children:'â„¹ï¸ Editing the "Account Created Date" allows you to correct when this account was created. The current UTC value is shown for reference.'})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"Balance"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(u,{label:"Current Balance",name:"balance",type:"number",step:"0.01",value:s.balance,onChange:t,placeholder:"0.00",error:i.balance}),e.jsx(u,{label:"Available Balance",name:"available_balance",type:"number",step:"0.01",value:s.available_balance,onChange:t,placeholder:"0.00",error:i.available_balance})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"Limits & Overdraft"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(u,{label:"Overdraft Limit",name:"overdraft_limit",type:"number",step:"0.01",value:s.overdraft_limit,onChange:t,placeholder:"0.00"}),e.jsx(u,{label:"Daily Transaction Limit",name:"daily_transaction_limit",type:"number",step:"0.01",value:s.daily_transaction_limit,onChange:t,placeholder:"10000.00"}),e.jsx(u,{label:"Monthly Transaction Limit",name:"monthly_transaction_limit",type:"number",step:"0.01",value:s.monthly_transaction_limit,onChange:t,placeholder:"100000.00"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t border-secondary",children:[e.jsx("button",{type:"button",onClick:o,disabled:l,className:"flex-1 py-3 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"flex-1 py-3 px-4 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"sm"})," Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{})," Save Account"]})})]})]})]})})},re=({userId:r,onClose:o,onSubmit:p,submitting:l})=>{const[s,x]=d.useState({account_type:"checking",currency:"USD"}),[i,b]=d.useState({}),t=v=>{const{name:n,value:m}=v.target;x(h=>({...h,[n]:m})),i[n]&&b(h=>({...h,[n]:""}))},g=v=>{v.preventDefault(),p(s)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-md w-full p-6 sm:p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary mb-6",children:"âž• Create New Account"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsx(w,{label:"Account Type",name:"account_type",value:s.account_type,onChange:t,options:[{value:"checking",label:"Checking"},{value:"savings",label:"Savings"},{value:"money_market",label:"Money Market"}],required:!0}),e.jsx(w,{label:"Currency",name:"currency",value:s.currency,onChange:t,options:[{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"},{value:"CAD",label:"CAD"}],required:!0}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-secondary",children:[e.jsx("button",{type:"button",onClick:o,disabled:l,className:"flex-1 py-2 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"flex-1 py-2 px-4 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"sm"})," Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{})," Create"]})})]})]})]})})},ne=({account:r,onConfirm:o,onCancel:p,submitting:l})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-secondary mb-4",children:"ðŸ—‘ï¸ Delete Account"}),e.jsxs("p",{className:"text-secondary opacity-70 mb-6",children:["Are you sure you want to delete account"," ",e.jsx("span",{className:"font-semibold",children:r?.account_number}),"? This action cannot be undone."]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-sm p-4 mb-6",children:e.jsx("p",{className:"text-sm text-red-800",children:"âš ï¸ This will soft-delete the account from the system."})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:p,disabled:l,className:"flex-1 py-2 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:o,disabled:l,className:"flex-1 py-2 px-4 bg-red-600 text-white font-semibold rounded-sm hover:bg-red-700 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"sm"})," Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{})," Delete"]})})]})]})}),ce=({user:r,onClose:o,onSubmit:p,submitting:l})=>{const[s,x]=d.useState({full_name:r?.full_name||"",phone_number:r?.phone_number||"",date_of_birth:r?.date_of_birth||"",nationality:r?.nationality||"",address:r?.address||"",city:r?.city||"",postal_code:r?.postal_code||"",country:r?.country||"",kyc_status:r?.kyc_status||"pending",is_active:r?.is_active!==!1?"true":"false",created_at:r?.created_at?new Date(r.created_at).toISOString().slice(0,16):""}),[i,b]=d.useState({}),t=n=>{const{name:m,value:h}=n.target;x(f=>({...f,[m]:h})),i[m]&&b(f=>({...f,[m]:""}))},g=()=>{const n={};return s.full_name||(n.full_name="Full name is required"),s.phone_number||(n.phone_number="Phone is required"),n},v=n=>{n.preventDefault();const m=g();if(Object.keys(m).length>0){b(m);return}const h=s.created_at?new Date(s.created_at).toISOString():r?.created_at;p({full_name:s.full_name,phone_number:s.phone_number,date_of_birth:s.date_of_birth||null,nationality:s.nationality||null,address:s.address||null,city:s.city||null,postal_code:s.postal_code||null,country:s.country||null,kyc_status:s.kyc_status,is_active:s.is_active==="true",created_at:h})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary",children:"âœï¸ Edit User Profile"}),e.jsx("button",{onClick:o,disabled:l,className:"text-secondary opacity-60 hover:opacity-100 transition-all",children:e.jsx($,{})})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(u,{label:"Full Name",name:"full_name",value:s.full_name,onChange:t,placeholder:"John Doe",required:!0,error:i.full_name}),e.jsx(u,{label:"Phone Number",name:"phone_number",value:s.phone_number,onChange:t,placeholder:"+31 6 XXXX XXXX",required:!0,error:i.phone_number}),e.jsx(u,{label:"Date of Birth",name:"date_of_birth",type:"date",value:s.date_of_birth,onChange:t}),e.jsx(u,{label:"Nationality",name:"nationality",value:s.nationality,onChange:t,placeholder:"Nationality"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"ðŸ“… Account Dates"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(u,{label:"Date Joined (Created At)",name:"created_at",type:"datetime-local",value:s.created_at,onChange:t,error:i.created_at}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:"Current Value (UTC)"}),e.jsx("div",{className:"px-4 py-3 border border-secondary rounded-sm bg-gray-50 text-secondary text-sm font-mono",children:r?.created_at?new Date(r.created_at).toISOString():"N/A"})]})]}),e.jsx("p",{className:"text-xs text-secondary opacity-60 mt-2",children:'â„¹ï¸ Editing the "Date Joined" allows you to correct account creation timestamps. The current UTC value is shown for reference.'})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"Address"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{label:"Street Address",name:"address",value:s.address,onChange:t,placeholder:"Street address"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(u,{label:"City",name:"city",value:s.city,onChange:t,placeholder:"City"}),e.jsx(u,{label:"Postal Code",name:"postal_code",value:s.postal_code,onChange:t,placeholder:"Postal code"}),e.jsx(u,{label:"Country",name:"country",value:s.country,onChange:t,placeholder:"Country"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider mb-4 opacity-80",children:"Account Status"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(w,{label:"Active Status",name:"is_active",value:s.is_active,onChange:t,options:[{value:"true",label:"Active"},{value:"false",label:"Suspended"}]}),e.jsx(w,{label:"KYC Status",name:"kyc_status",value:s.kyc_status,onChange:t,options:[{value:"pending",label:"Pending"},{value:"verified",label:"Verified"},{value:"rejected",label:"Rejected"},{value:"suspended",label:"Suspended"}]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t border-secondary",children:[e.jsx("button",{type:"button",onClick:o,disabled:l,className:"flex-1 py-3 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"flex-1 py-3 px-4 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"sm"})," Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{})," Save Changes"]})})]})]})]})})},de=()=>{const r=Q(),{id:o}=Z(),[p,l]=d.useState(!1),[s,x]=d.useState(!1),[i,b]=d.useState(""),[t,g]=d.useState(null),[v,n]=d.useState([]),[m,h]=d.useState(!0),[f,N]=d.useState(!1),[L,H]=d.useState("profile"),[W,E]=d.useState(!1),[A,U]=d.useState(null),[D,I]=d.useState(null),[V,F]=d.useState(!1),[T,y]=d.useState({type:"",text:""});d.useEffect(()=>{if(!ee()){r("/user/admin/auth/login",{replace:!0});return}l(!0);const c=sessionStorage.getItem("admin_email")||"admin@example.com";b(c)},[r]),d.useEffect(()=>{if(!p||!o)return;(async()=>{try{h(!0);const{data:c,error:j}=await S.from("user_profiles").select("*").eq("id",o).eq("is_deleted",!1).single();if(j)throw j;g(c);const{data:_,error:k}=await S.from("accounts").select("*").eq("user_id",o).eq("is_deleted",!1).order("created_at",{ascending:!1});if(k)throw k;n(_||[])}catch(c){console.error("[USER_DETAIL] Fetch error:",c),y({type:"error",text:"Failed to load user data"})}finally{h(!1)}})()},[p,o]);const G=async a=>{N(!0);try{const c={full_name:a.full_name,phone_number:a.phone_number,date_of_birth:a.date_of_birth||null,nationality:a.nationality||null,address:a.address||null,city:a.city||null,postal_code:a.postal_code||null,country:a.country||null,kyc_status:a.kyc_status,is_active:a.is_active,updated_at:new Date().toISOString()};a.created_at&&(c.created_at=a.created_at);const{error:j}=await S.from("user_profiles").update(c).eq("id",o);if(j)throw j;g(_=>({..._,...a,updated_at:new Date().toISOString()})),y({type:"success",text:"âœ… Profile updated successfully"}),E(!1),setTimeout(()=>y({type:"",text:""}),3e3)}catch(c){console.error("[USER_DETAIL] Update error:",c),y({type:"error",text:c?.message||"Failed to update profile"})}finally{N(!1)}},J=async a=>{N(!0);try{const c=Math.floor(Math.random()*9e9+1e9).toString(),{data:j,error:_}=await S.from("accounts").insert({user_id:o,account_number:c,account_type:a.account_type,currency:a.currency,status:"active",balance:0,available_balance:0,metadata:{},feature_flags:{},settings:{}}).select().single();if(_)throw _;n(k=>[j,...k]),y({type:"success",text:`âœ… Account created! Account #: ${c}`}),F(!1),setTimeout(()=>y({type:"",text:""}),3e3)}catch(c){console.error("[USER_DETAIL] Create account error:",c),y({type:"error",text:c?.message||"Failed to create account"})}finally{N(!1)}},K=async a=>{N(!0);try{const c=a.created_at?new Date(a.created_at).toISOString():A?.created_at,j={account_type:a.account_type,currency:a.currency,balance:a.balance,available_balance:a.available_balance,status:a.status,overdraft_limit:a.overdraft_limit,daily_transaction_limit:a.daily_transaction_limit,monthly_transaction_limit:a.monthly_transaction_limit,created_at:c,updated_at:new Date().toISOString()},{error:_}=await S.from("accounts").update(j).eq("id",A.id);if(_)throw _;n(k=>k.map(M=>M.id===A.id?{...M,...a,created_at:c,updated_at:new Date().toISOString()}:M)),y({type:"success",text:"âœ… Account updated successfully"}),U(null),setTimeout(()=>y({type:"",text:""}),3e3)}catch(c){console.error("[USER_DETAIL] Update account error:",c),y({type:"error",text:c?.message||"Failed to update account"})}finally{N(!1)}},Y=async()=>{N(!0);try{const{error:a}=await S.from("accounts").update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_reason:"Deleted by admin",status:"closed"}).eq("id",D.id);if(a)throw a;n(c=>c.filter(j=>j.id!==D.id)),y({type:"success",text:"âœ… Account deleted successfully"}),I(null),setTimeout(()=>y({type:"",text:""}),3e3)}catch(a){console.error("[USER_DETAIL] Delete account error:",a),y({type:"error",text:a?.message||"Failed to delete account"})}finally{N(!1)}};return p?m?e.jsxs("div",{className:"min-h-screen bg-primary",children:[e.jsx(O,{adminEmail:i,onMenuToggle:()=>x(!s)}),e.jsxs("div",{className:"flex",children:[e.jsx(P,{isOpen:s,onClose:()=>x(!1)}),e.jsx("main",{className:"flex-1 flex items-center justify-center",children:e.jsx(C,{size:"lg"})})]})]}):t?e.jsxs("div",{className:"min-h-screen bg-primary",children:[e.jsx(O,{adminEmail:i,onMenuToggle:()=>x(!s)}),e.jsxs("div",{className:"flex",children:[e.jsx(P,{isOpen:s,onClose:()=>x(!1)}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"container mx-auto max-w-7xl px-4 sm:px-6 py-6 sm:py-8",children:[e.jsxs("button",{onClick:()=>r("/admin/users"),className:"flex items-center gap-2 text-basic hover:opacity-80 transition-all mb-6",children:[e.jsx(B,{})," Back to Users"]}),T.text&&e.jsx("div",{className:`mb-6 p-4 rounded-sm border-l-4 ${T.type==="success"?"bg-green-50 border-green-500 text-green-800":"bg-red-50 border-red-500 text-red-800"}`,children:e.jsx("p",{className:"text-sm font-semibold",children:T.text})}),e.jsx("div",{className:"bg-primary border border-secondary rounded-sm shadow-md p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 flex-shrink-0 text-basic opacity-30 rounded-full overflow-hidden bg-basic bg-opacity-5 flex items-center justify-center",children:t?.profile_image_url?e.jsx("img",{src:t.profile_image_url,alt:t.full_name,className:"w-full h-full object-cover"}):e.jsx(se,{})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-secondary",children:t.full_name}),e.jsx("p",{className:"text-secondary opacity-70 mt-1",children:t.email}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold ${t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[t.is_active?e.jsx(te,{}):"ðŸ”’",t.is_active?"Active":"Suspended"]}),e.jsxs("span",{className:`text-xs font-semibold px-3 py-1 rounded capitalize ${t.kyc_status==="verified"?"bg-green-100 text-green-800":t.kyc_status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:["KYC: ",t.kyc_status]})]})]}),e.jsxs("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 transition-all flex items-center gap-2",children:[e.jsx(z,{})," Edit Profile"]})]})}),e.jsx("div",{className:"flex gap-4 mb-6 border-b border-secondary",children:["profile","accounts"].map(a=>e.jsx("button",{onClick:()=>H(a),className:`px-4 py-3 font-semibold text-sm uppercase tracking-wider transition-all border-b-2 ${L===a?"border-basic text-basic":"border-transparent text-secondary opacity-60 hover:opacity-100"}`,children:a==="profile"?"ðŸ‘¤ Profile":"ðŸ’³ Accounts"},a))}),L==="profile"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"ðŸ“‹ Personal Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Full Name"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.full_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Email"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Phone"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.phone_number||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Date of Birth"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.date_of_birth?new Date(t.date_of_birth).toLocaleDateString():"-"})]})]})]}),e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"ðŸ  Address"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Street Address"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.address||"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"City"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.city||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Postal Code"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.postal_code||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Country"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.country||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Nationality"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.nationality||"-"})]})]})]})]}),e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"ðŸ” Account Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Status"}),e.jsx("p",{className:`text-sm font-semibold ${t.is_active?"text-green-600":"text-red-600"}`,children:t.is_active?"Active":"Suspended"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"KYC Status"}),e.jsx("p",{className:`text-sm font-semibold capitalize ${t.kyc_status==="verified"?"text-green-600":t.kyc_status==="pending"?"text-yellow-600":"text-red-600"}`,children:t.kyc_status})]})]})]}),e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"ðŸ“… Account Dates"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Date Joined"}),e.jsxs("p",{className:"text-sm font-semibold text-secondary",children:[new Date(t.created_at).toLocaleDateString()," at"," ",new Date(t.created_at).toLocaleTimeString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Last Updated"}),e.jsxs("p",{className:"text-sm font-semibold text-secondary",children:[new Date(t.updated_at).toLocaleDateString()," at"," ",new Date(t.updated_at).toLocaleTimeString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Last Login"}),e.jsx("p",{className:"text-sm font-semibold text-secondary",children:t.last_login?new Date(t.last_login).toLocaleDateString():"Never"})]})]})]})]}),L==="accounts"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary",children:"ðŸ’³ Linked Accounts"}),e.jsxs("button",{onClick:()=>F(!0),className:"flex items-center gap-2 px-4 py-2 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 transition-all",children:[e.jsx(X,{})," Create Account"]})]}),v.length===0?e.jsx("div",{className:"bg-primary border border-secondary rounded-sm p-12 text-center",children:e.jsx("p",{className:"text-secondary opacity-70",children:"No accounts yet. Create one to get started."})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:v.map(a=>e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:a.account_number}),e.jsxs("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mt-1",children:[a.account_type," â€¢ ",a.currency]})]}),e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded capitalize ${a.status==="active"?"bg-green-100 text-green-800":a.status==="frozen"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:a.status})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Balance"}),e.jsxs("p",{className:"text-2xl font-bold text-basic",children:[a.currency," ",a.balance.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Available"}),e.jsxs("p",{className:"text-sm font-semibold text-secondary",children:[a.currency," ",a.available_balance.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Daily Limit"}),e.jsxs("p",{className:"text-sm font-semibold text-secondary",children:[a.currency," ",a.daily_transaction_limit.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-secondary",children:[e.jsxs("button",{onClick:()=>U(a),className:"flex-1 py-2 px-3 bg-basic bg-opacity-10 text-basic font-semibold rounded-sm hover:bg-opacity-20 transition-all flex items-center justify-center gap-2 text-sm",children:[e.jsx(z,{})," Edit"]}),e.jsxs("button",{onClick:()=>I(a),className:"flex-1 py-2 px-3 bg-red-100 text-red-600 font-semibold rounded-sm hover:bg-red-200 transition-all flex items-center justify-center gap-2 text-sm",children:[e.jsx(R,{})," Delete"]})]})]},a.id))})]})]})})]}),W&&e.jsx(ce,{user:t,onClose:()=>E(!1),onSubmit:G,submitting:f}),A&&e.jsx(ae,{account:A,onClose:()=>U(null),onSubmit:K,submitting:f}),D&&e.jsx(ne,{account:D,onConfirm:Y,onCancel:()=>I(null),submitting:f}),V&&e.jsx(re,{userId:o,onClose:()=>F(!1),onSubmit:J,submitting:f})]}):e.jsxs("div",{className:"min-h-screen bg-primary",children:[e.jsx(O,{adminEmail:i,onMenuToggle:()=>x(!s)}),e.jsxs("div",{className:"flex",children:[e.jsx(P,{isOpen:s,onClose:()=>x(!1)}),e.jsx("main",{className:"flex-1",children:e.jsxs("div",{className:"container mx-auto max-w-7xl px-4 sm:px-6 py-6",children:[e.jsxs("button",{onClick:()=>r("/admin/users"),className:"flex items-center gap-2 text-basic hover:opacity-80 transition-all mb-6",children:[e.jsx(B,{})," Back to Users"]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-sm p-6 text-center",children:e.jsx("p",{className:"text-red-800 font-semibold",children:"User not found"})})]})})]})]}):e.jsx("div",{className:"min-h-screen bg-primary flex items-center justify-center",children:e.jsx(C,{size:"lg"})})};export{de as default};
