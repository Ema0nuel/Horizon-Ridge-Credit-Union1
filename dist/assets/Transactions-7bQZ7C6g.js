import{u as Ne,r as v,j as e,a as U,s as b}from"./index-BaOxJvox.js";import{i as we}from"./adminAuth-L83m0e2d.js";import{H as Se,S as Ce}from"./SideBar-DQioEHc3.js";const ke=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),me=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),X=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),se=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),xe=()=>e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),be=()=>e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})}),re=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),Te=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Ae=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),Fe=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 2m6-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),le=()=>e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),Q=s=>{if(!s)return"";const n=new Date(s),d=n.getFullYear(),u=String(n.getMonth()+1).padStart(2,"0"),y=String(n.getDate()).padStart(2,"0"),i=String(n.getHours()).padStart(2,"0"),a=String(n.getMinutes()).padStart(2,"0");return`${d}-${u}-${y}T${i}:${a}`},ee=s=>s?new Date(s).toISOString():null,B=s=>["withdrawal","payment","loan_repayment"].includes(s),ne=s=>["deposit","tax_refund"].includes(s),M=s=>["loan_disbursement","loan_repayment"].includes(s),de=({label:s,name:n,type:d="text",value:u,onChange:y,placeholder:i,disabled:a=!1,error:N,required:p=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:[s,p&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsx("input",{type:d,name:n,value:u,onChange:y,placeholder:i,disabled:a,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans text-sm ${N?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${a?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`}),N&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:N})]}),te=({label:s,name:n,value:d,onChange:u,disabled:y=!1,error:i,required:a=!1,helper:N=""})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80 flex items-center gap-1",children:[e.jsx(Fe,{}),s,a&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsx("input",{type:"datetime-local",name:n,value:d,onChange:u,disabled:y,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans text-sm ${i?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${y?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`}),N&&e.jsx("p",{className:"text-xs text-secondary opacity-60 mt-1",children:N}),i&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:i})]}),pe=({label:s,name:n,value:d,onChange:u,placeholder:y,disabled:i=!1,error:a,rows:N=3})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:s}),e.jsx("textarea",{name:n,value:d,onChange:u,placeholder:y,disabled:i,rows:N,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans text-sm resize-none ${a?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${i?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`}),a&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:a})]}),V=({label:s,name:n,value:d,onChange:u,options:y,disabled:i=!1,error:a,required:N=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:[s,N&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsxs("select",{name:n,value:d,onChange:u,disabled:i,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans text-sm ${a?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${i?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`,children:[e.jsxs("option",{value:"",children:["Select ",s.toLowerCase()]}),y.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))]}),a&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:a})]}),ae=({title:s,icon:n,isOpen:d,onToggle:u,children:y})=>e.jsxs("div",{className:"border border-secondary rounded-sm overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:u,className:"w-full px-6 py-4 bg-secondary bg-opacity-5 hover:bg-opacity-10 flex items-center justify-between transition-all",children:[e.jsxs("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{children:n}),s]}),e.jsx(Ae,{className:`w-5 h-5 transition-transform ${d?"rotate-180":""}`})]}),d&&e.jsx("div",{className:"px-6 py-4 bg-primary border-t border-secondary",children:y})]}),Ee=({transaction:s,accounts:n,onClose:d,onEditClick:u})=>{const y=n.find(C=>C.id===s?.from_account_id),i=n.find(C=>C.id===s?.to_account_id),a=B(s?.transaction_type),N=ne(s?.transaction_type);M(s?.transaction_type);const p=N?"CREDIT (Balance +)":a?"DEBIT (Balance -)":"TRANSFER";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary",children:"ðŸ“‹ Transaction Details"}),e.jsx("button",{onClick:d,className:"text-secondary opacity-60 hover:opacity-100 transition-all",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-1",children:"Reference"}),e.jsx("p",{className:"font-mono font-bold text-basic text-sm",children:s?.reference_number})]}),e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-1",children:"Amount"}),e.jsxs("p",{className:"font-bold text-lg text-basic",children:[s?.currency," ",s?.amount?.toFixed(2)]})]}),e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-1",children:"Status"}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold ${s?.status==="completed"?"bg-green-100 text-green-800":s?.status==="pending"?"bg-yellow-100 text-yellow-800":s?.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[s?.status==="completed"&&e.jsx(xe,{}),s?.status==="failed"&&e.jsx(be,{}),s?.status?.charAt(0).toUpperCase()+s?.status?.slice(1)]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Type"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-secondary capitalize text-sm",children:s?.transaction_type.replace(/_/g," ")}),e.jsx("p",{className:"text-xs text-secondary opacity-60 mt-1",children:p})]})]}),e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"From Account"}),e.jsx("p",{className:"font-semibold text-secondary",children:y?.account_number||"Unknown"}),e.jsxs("p",{className:"text-xs text-secondary opacity-60 mt-1",children:["Balance: ",y?.currency," ",y?.balance?.toFixed(2)]})]})]}),i&&e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"To Account"}),e.jsx("p",{className:"font-semibold text-secondary",children:i.account_number}),e.jsxs("p",{className:"text-xs text-secondary opacity-60 mt-1",children:["Balance: ",i.currency," ",i.balance?.toFixed(2)]})]}),s?.external_recipient_iban&&e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"External Recipient"}),e.jsx("p",{className:"font-semibold text-secondary",children:s?.external_recipient_name}),e.jsx("p",{className:"font-mono text-xs text-secondary mt-1",children:s?.external_recipient_iban})]}),s?.description&&e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-secondary",children:s?.description})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Created"}),e.jsx("p",{className:"font-semibold text-secondary text-sm",children:new Date(s?.created_at).toLocaleString()})]}),e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Approved"}),e.jsx("p",{className:"font-semibold text-secondary text-sm",children:s?.approved_at?new Date(s.approved_at).toLocaleString():"â€”"})]}),e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Completed"}),e.jsx("p",{className:"font-semibold text-secondary text-sm",children:s?.completed_at?new Date(s.completed_at).toLocaleString():"â€”"})]})]}),s?.failure_reason&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-red-800 font-semibold uppercase tracking-wider mb-2",children:"Failure Reason"}),e.jsx("p",{className:"text-sm text-red-800",children:s?.failure_reason})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t border-secondary",children:[e.jsx("button",{onClick:d,className:"flex-1 py-3 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all",children:"Close"}),e.jsxs("button",{onClick:u,className:"flex-1 py-3 px-4 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 transition-all flex items-center justify-center gap-2",children:[e.jsx(X,{})," Edit Transaction"]})]})]})]})})},ue=({mode:s,transaction:n,accounts:d,onClose:u,onSubmit:y,submitting:i})=>{const[a,N]=v.useState({from_account_id:n?.from_account_id||"",to_account_id:n?.to_account_id||"",external_recipient_name:n?.external_recipient_name||"",external_recipient_iban:n?.external_recipient_iban||"",amount:n?.amount||"",currency:n?.currency||"USD",transaction_type:n?.transaction_type||"deposit",status:n?.status||"pending",description:n?.description||"",failure_reason:n?.failure_reason||"",created_at:Q(n?n.created_at:new Date().toISOString()),approved_at:n?.approved_at?Q(n.approved_at):"",completed_at:n?.completed_at?Q(n.completed_at):""}),[p,C]=v.useState({}),[w,L]=v.useState({basic:!0,accounts:!0,timestamps:!1,notes:!1}),F=c=>{L(j=>({...j,[c]:!j[c]}))},g=c=>{const{name:j,value:x}=c.target;N(q=>({...q,[j]:j==="amount"?x?parseFloat(x):"":x})),p[j]&&C(q=>({...q,[j]:""}))},$=()=>{const c={},j=parseFloat(a.amount);if(a.from_account_id||(c.from_account_id="Source account required"),(!j||j<=0)&&(c.amount="Amount must be greater than 0"),a.currency||(c.currency="Currency required"),a.transaction_type||(c.transaction_type="Transaction type required"),a.created_at||(c.created_at="Created date required"),a.created_at&&a.approved_at){const k=new Date(a.created_at).getTime();new Date(a.approved_at).getTime()<k&&(c.approved_at="Approved time must be after created time")}if(a.approved_at&&a.completed_at){const k=new Date(a.approved_at).getTime();new Date(a.completed_at).getTime()<k&&(c.completed_at="Completed time must be after approved time")}a.transaction_type==="transfer"&&(a.to_account_id||(c.to_account_id="Destination account required"),a.from_account_id===a.to_account_id&&(c.to_account_id="Cannot transfer to same account")),a.transaction_type==="external_transfer"&&(a.external_recipient_iban||(c.external_recipient_iban="Recipient IBAN required"),a.external_recipient_name||(c.external_recipient_name="Recipient name required"));const x=B(a.transaction_type),q=M(a.transaction_type);if(x&&!q&&a.status==="completed"){const k=d.find(E=>E.id===a.from_account_id);k&&k.balance<j&&(c.amount=`Insufficient balance. Available: ${k.currency} ${k.balance.toFixed(2)}, Required: ${a.currency} ${j.toFixed(2)}`)}if(a.transaction_type==="transfer"&&a.to_account_id){const k=d.find(A=>A.id===a.from_account_id),E=d.find(A=>A.id===a.to_account_id);k&&E&&k.currency!==E.currency&&(c.currency="Source and destination accounts have different currencies")}return c},I=c=>{c.preventDefault();const j=$();if(Object.keys(j).length>0){C(j);return}y({from_account_id:a.from_account_id,to_account_id:a.to_account_id||null,external_recipient_name:a.external_recipient_name||null,external_recipient_iban:a.external_recipient_iban||null,amount:parseFloat(a.amount),currency:a.currency,transaction_type:a.transaction_type,status:a.status,description:a.description||null,failure_reason:a.failure_reason||null,created_at:ee(a.created_at),approved_at:a.approved_at?ee(a.approved_at):null,completed_at:a.completed_at?ee(a.completed_at):null})},R=d.find(c=>c.id===a.from_account_id),O=d.find(c=>c.id===a.to_account_id);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-4xl w-full max-h-[95vh] overflow-y-auto p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary",children:s==="create"?"âž• Create Transaction":"âœï¸ Edit Transaction"}),e.jsx("button",{onClick:u,disabled:i,className:"text-secondary opacity-60 hover:opacity-100 transition-all",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs(ae,{title:"Basic Information",icon:"ðŸ’³",isOpen:w.basic,onToggle:()=>F("basic"),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(V,{label:"Transaction Type",name:"transaction_type",value:a.transaction_type,onChange:g,options:[{value:"deposit",label:"Deposit (Credit)"},{value:"withdrawal",label:"Withdrawal (Debit)"},{value:"transfer",label:"Transfer (Debit)"},{value:"tax_refund",label:"Tax Refund (Credit)"},{value:"loan_disbursement",label:"Loan Disbursement"},{value:"loan_repayment",label:"Loan Repayment (Debit)"},{value:"external_transfer",label:"External Transfer (Debit)"},{value:"payment",label:"Payment (Debit)"}],required:!0,error:p.transaction_type}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:["Amount ",e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",name:"amount",value:a.amount,onChange:g,placeholder:"0.00",step:"0.01",min:"0",className:`flex-1 px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans text-sm ${p.amount?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"}`}),e.jsx(V,{label:"Currency",name:"currency",value:a.currency,onChange:g,options:[{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"},{value:"CAD",label:"CAD"}],error:p.currency})]}),p.amount&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:p.amount})]})]}),e.jsx(V,{label:"Status",name:"status",value:a.status,onChange:g,options:[{value:"pending",label:"Pending (Awaiting Approval)"},{value:"completed",label:"Completed (Approved)"},{value:"failed",label:"Failed"},{value:"on_hold",label:"On Hold"},{value:"reversed",label:"Reversed"}],required:!0,error:p.status}),a.status==="failed"&&e.jsx(pe,{label:"Failure Reason",name:"failure_reason",value:a.failure_reason,onChange:g,placeholder:"Explain why this transaction failed...",rows:2}),e.jsx(pe,{label:"Description",name:"description",value:a.description,onChange:g,placeholder:"Optional: Transaction notes or reference",rows:2})]}),e.jsxs(ae,{title:"Account Details",icon:"ðŸ¦",isOpen:w.accounts,onToggle:()=>F("accounts"),children:[e.jsx(V,{label:"From Account (Source)",name:"from_account_id",value:a.from_account_id,onChange:g,options:d.map(c=>({value:c.id,label:`${c.account_number} (${c.currency} ${c.balance.toFixed(2)}) - ${c.account_type}`})),required:!0,error:p.from_account_id}),R&&e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4 mb-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Source Account Balance"}),e.jsxs("p",{className:"text-lg font-bold text-basic",children:[R.currency," ",R.balance.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-secondary opacity-60 mt-1",children:["Available: ",R.currency," ",R.available_balance.toFixed(2)]})]}),a.transaction_type==="transfer"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{label:"To Account (Destination)",name:"to_account_id",value:a.to_account_id,onChange:g,options:d.filter(c=>c.id!==a.from_account_id).map(c=>({value:c.id,label:`${c.account_number} (${c.currency} ${c.balance.toFixed(2)})`})),required:!0,error:p.to_account_id}),O&&e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Destination Account Balance"}),e.jsxs("p",{className:"text-lg font-bold text-basic",children:[O.currency," ",O.balance.toFixed(2)]})]})]}),a.transaction_type==="external_transfer"&&e.jsxs(e.Fragment,{children:[e.jsx(de,{label:"Recipient Name",name:"external_recipient_name",value:a.external_recipient_name,onChange:g,placeholder:"Full name of recipient",required:!0,error:p.external_recipient_name}),e.jsx(de,{label:"Recipient IBAN",name:"external_recipient_iban",value:a.external_recipient_iban,onChange:g,placeholder:"International Bank Account Number",required:!0,error:p.external_recipient_iban})]})]}),e.jsxs(ae,{title:"Transaction Timestamps",icon:"ðŸ•",isOpen:w.timestamps,onToggle:()=>F("timestamps"),children:[e.jsx(te,{label:"Created Date & Time",name:"created_at",value:a.created_at,onChange:g,required:!0,helper:"When the transaction was initiated",error:p.created_at}),a.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsx(te,{label:"Approved Date & Time",name:"approved_at",value:a.approved_at,onChange:g,helper:"When the transaction was approved by admin",error:p.approved_at}),e.jsx(te,{label:"Completed Date & Time",name:"completed_at",value:a.completed_at,onChange:g,helper:"When the transaction was finalized",error:p.completed_at})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t border-secondary mt-6",children:[e.jsx("button",{type:"button",onClick:u,disabled:i,className:"flex-1 py-3 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",onClick:I,disabled:i,className:"flex-1 py-3 px-4 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(U,{size:"sm"})," Saving..."]}):s==="create"?e.jsxs(e.Fragment,{children:[e.jsx(me,{})," Create Transaction"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{})," Save Changes"]})})]})]})})},Le=({transaction:s,accounts:n,onApprove:d,onReject:u,onCancel:y,submitting:i})=>{const a=n.find(w=>w.id===s?.from_account_id),N=B(s?.transaction_type),p=M(s?.transaction_type),C=N&&!p&&a&&a.balance<s?.amount;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-md w-full p-6 sm:p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary mb-6",children:"ðŸ” Review Transaction"}),e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4 mb-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Reference"}),e.jsx("p",{className:"font-mono font-bold text-basic text-sm",children:s?.reference_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Amount"}),e.jsxs("p",{className:"text-lg font-bold text-basic",children:[s?.currency," ",s?.amount?.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider",children:"Type"}),e.jsx("p",{className:"capitalize text-secondary font-semibold",children:s?.transaction_type.replace(/_/g," ")})]})]}),a&&e.jsxs("div",{className:"bg-secondary bg-opacity-5 border border-secondary rounded-sm p-4 mb-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 uppercase tracking-wider mb-2",children:"Source Account"}),e.jsx("p",{className:"font-semibold text-secondary",children:a.account_number}),e.jsxs("p",{className:"text-xs text-secondary opacity-60 mt-1",children:["Current Balance: ",a.currency," ",a.balance.toFixed(2)]})]}),C&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-sm p-4 mb-4",children:[e.jsx("p",{className:"text-sm font-semibold text-red-800 mb-2",children:"âš ï¸ INSUFFICIENT FUNDS"}),e.jsxs("p",{className:"text-xs text-red-800",children:["Account balance (",a?.currency," ",a?.balance.toFixed(2),") is less than transaction amount (",s?.currency," ",s?.amount?.toFixed(2),")"]})]}),p&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-sm p-4 mb-4",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-800",children:"ðŸ’° Loan Transaction"}),e.jsx("p",{className:"text-xs text-blue-800 mt-1",children:"Balance will not be affected. Loan records will be updated."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:y,disabled:i,className:"flex-1 py-2 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:u,disabled:i||C,className:"flex-1 py-2 px-4 bg-red-100 text-red-600 font-semibold rounded-sm hover:bg-red-200 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(U,{size:"sm"})," Rejecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{})," Reject"]})}),e.jsx("button",{onClick:d,disabled:i||C,className:"flex-1 py-2 px-4 bg-green-100 text-green-600 font-semibold rounded-sm hover:bg-green-200 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(U,{size:"sm"})," Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{})," Approve"]})})]})]})})},$e=({transaction:s,onConfirm:n,onCancel:d,submitting:u})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-lg max-w-md w-full p-6 sm:p-8",children:[e.jsx("h3",{className:"text-xl font-bold text-secondary mb-4",children:"ðŸ—‘ï¸ Delete Transaction"}),e.jsxs("p",{className:"text-secondary opacity-70 mb-6",children:["Are you sure you want to permanently delete transaction"," ",e.jsx("span",{className:"font-mono font-semibold",children:s?.reference_number}),"?"]}),s?.status==="completed"&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-sm p-4 mb-6",children:[e.jsx("p",{className:"text-sm font-semibold text-red-800 mb-2",children:"âš ï¸ COMPLETED TRANSACTION"}),e.jsx("p",{className:"text-xs text-red-800",children:"This transaction is completed. Deleting it will REVERSE all balance changes made by this transaction."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:d,disabled:u,className:"flex-1 py-2 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:n,disabled:u,className:"flex-1 py-2 px-4 bg-red-600 text-white font-semibold rounded-sm hover:bg-red-700 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx(U,{size:"sm"})," Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{})," Delete"]})})]})]})}),qe=()=>{const s=Ne(),[n,d]=v.useState(!1),[u,y]=v.useState(""),[i,a]=v.useState(!1),[N,p]=v.useState(!0),[C,w]=v.useState(!1),[L,F]=v.useState([]),[g,$]=v.useState([]),[I,R]=v.useState(""),[O,c]=v.useState("all"),[j,x]=v.useState({type:"",text:""}),[q,k]=v.useState(!1),[E,A]=v.useState(null),[z,D]=v.useState(null),[W,P]=v.useState(null),[J,G]=v.useState(null);v.useEffect(()=>{(async()=>{try{if(!await we()){s("/user/admin/auth/login");return}d(!0);const{data:m}=await b.auth.getUser();y(m?.user?.email||"Admin"),await ye(),await he()}catch(r){console.error("[AUTH_ERROR]",r),s("/admin/login")}finally{p(!1)}})()},[s]);const ye=async()=>{try{const{data:t,error:r}=await b.from("transactions").select("*").order("created_at",{ascending:!1});if(r)throw r;F(t||[])}catch(t){console.error("[FETCH_TRANSACTIONS]",t),x({type:"error",text:"Failed to load transactions"})}},he=async()=>{try{const{data:t,error:r}=await b.from("accounts").select("*").eq("is_deleted",!1);if(r)throw r;$(t||[])}catch(t){console.error("[FETCH_ACCOUNTS]",t),x({type:"error",text:"Failed to load accounts"})}},Y=async t=>{try{const r=B(t.transaction_type),m=ne(t.transaction_type);if(M(t.transaction_type))return;const{data:S,error:f}=await b.from("accounts").select("*").eq("is_deleted",!1);if(f)throw f;const o=S.find(l=>l.id===t.from_account_id);if(!o)throw new Error("Source account not found");if(m){const{error:l}=await b.from("accounts").update({balance:o.balance+t.amount,available_balance:o.available_balance+t.amount,updated_at:new Date().toISOString()}).eq("id",t.from_account_id);if(l)throw l;$(h=>h.map(_=>_.id===t.from_account_id?{..._,balance:o.balance+t.amount,available_balance:o.available_balance+t.amount,updated_at:new Date().toISOString()}:_));return}if(t.transaction_type==="transfer"){const l=S.find(Z=>Z.id===t.to_account_id);if(!l)throw new Error("Destination account not found");if(o.balance<t.amount)throw new Error(`Insufficient balance in source account. Available: ${o.currency} ${o.balance.toFixed(2)}, Required: ${t.currency} ${t.amount.toFixed(2)}`);const{error:h}=await b.from("accounts").update({balance:o.balance-t.amount,available_balance:o.available_balance-t.amount,updated_at:new Date().toISOString()}).eq("id",t.from_account_id);if(h)throw h;const{error:_}=await b.from("accounts").update({balance:l.balance+t.amount,available_balance:l.available_balance+t.amount,updated_at:new Date().toISOString()}).eq("id",t.to_account_id);if(_)throw _;$(Z=>Z.map(H=>H.id===t.from_account_id?{...H,balance:o.balance-t.amount,available_balance:o.available_balance-t.amount,updated_at:new Date().toISOString()}:H.id===t.to_account_id?{...H,balance:l.balance+t.amount,available_balance:l.available_balance+t.amount,updated_at:new Date().toISOString()}:H));return}if(r){if(o.balance<t.amount)throw new Error(`Insufficient balance. Available: ${o.currency} ${o.balance.toFixed(2)}, Required: ${t.currency} ${t.amount.toFixed(2)}`);const{error:l}=await b.from("accounts").update({balance:o.balance-t.amount,available_balance:o.available_balance-t.amount,updated_at:new Date().toISOString()}).eq("id",t.from_account_id);if(l)throw l;$(h=>h.map(_=>_.id===t.from_account_id?{..._,balance:o.balance-t.amount,available_balance:o.available_balance-t.amount,updated_at:new Date().toISOString()}:_))}}catch(r){throw console.error("[BALANCE_UPDATE] Error:",r.message),r}},ce=async t=>{try{const r=B(t.transaction_type),m=ne(t.transaction_type);if(M(t.transaction_type))return;const{data:S,error:f}=await b.from("accounts").select("*").eq("is_deleted",!1);if(f)throw f;if(t.transaction_type==="transfer"){const l=S.find(_=>_.id===t.from_account_id),h=S.find(_=>_.id===t.to_account_id);if(l){const{error:_}=await b.from("accounts").update({balance:l.balance+t.amount,available_balance:l.available_balance+t.amount,updated_at:new Date().toISOString()}).eq("id",t.from_account_id);if(_)throw _}if(h){const{error:_}=await b.from("accounts").update({balance:h.balance-t.amount,available_balance:h.available_balance-t.amount,updated_at:new Date().toISOString()}).eq("id",t.to_account_id);if(_)throw _}}else if(r){const l=S.find(h=>h.id===t.from_account_id);if(l){const{error:h}=await b.from("accounts").update({balance:l.balance+t.amount,available_balance:l.available_balance+t.amount,updated_at:new Date().toISOString()}).eq("id",t.from_account_id);if(h)throw h}}else if(m){const l=S.find(h=>h.id===t.from_account_id);if(l){const{error:h}=await b.from("accounts").update({balance:l.balance-t.amount,available_balance:l.available_balance-t.amount,updated_at:new Date().toISOString()}).eq("id",t.from_account_id);if(h)throw h}}const{data:o}=await b.from("accounts").select("*").eq("is_deleted",!1);$(o||[])}catch(r){throw console.error("[BALANCE_REVERSE] Error:",r.message),r}},fe=async t=>{w(!0);try{const r=`TXN-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`;if(t.status==="completed"){const f=B(t.transaction_type);if(!M(t.transaction_type)&&f){const l=g.find(h=>h.id===t.from_account_id);if(l&&l.balance<t.amount)throw new Error(`Insufficient balance. Available: ${l.currency} ${l.balance.toFixed(2)}, Required: ${t.currency} ${t.amount.toFixed(2)}`)}}const{data:m,error:T}=await b.from("transactions").insert([{from_account_id:t.from_account_id,to_account_id:t.to_account_id||null,external_recipient_name:t.external_recipient_name||null,external_recipient_iban:t.external_recipient_iban||null,amount:t.amount,currency:t.currency,transaction_type:t.transaction_type,status:t.status,description:t.description||null,reference_number:r,failure_reason:t.failure_reason||null,created_at:t.created_at,approved_at:t.approved_at||null,completed_at:t.completed_at||null,metadata:{created_by:"admin",initiated_at:new Date().toISOString()}}]).select();if(T)throw T;if(!m||m.length===0)throw new Error("Transaction was created but response is empty");const S=m[0];if(t.status==="completed")try{await Y(t)}catch(f){throw await b.from("transactions").delete().eq("id",S.id),new Error(`Balance update failed: ${f.message}`)}F(f=>[S,...f]),x({type:"success",text:`âœ… Transaction created! Ref: ${r}${t.status==="completed"?" (Balance updated)":""}`}),k(!1),setTimeout(()=>x({type:"",text:""}),4e3)}catch(r){console.error("[CREATE_TRANSACTION]",r.message),x({type:"error",text:`Failed to create transaction: ${r.message}`})}finally{w(!1)}},ge=async t=>{w(!0);try{const r=z,m=r.status,T=t.status,{error:S}=await b.from("transactions").update({from_account_id:t.from_account_id,to_account_id:t.to_account_id||null,external_recipient_name:t.external_recipient_name||null,external_recipient_iban:t.external_recipient_iban||null,amount:t.amount,currency:t.currency,transaction_type:t.transaction_type,status:t.status,description:t.description||null,failure_reason:t.failure_reason||null,created_at:t.created_at,approved_at:t.approved_at,completed_at:t.completed_at,updated_at:new Date().toISOString()}).eq("id",z.id);if(S)throw S;if(m==="completed"&&await ce(r),T==="completed")try{await Y(t)}catch(f){throw await b.from("transactions").update({status:m,updated_at:new Date().toISOString()}).eq("id",z.id),new Error(`Balance validation failed: ${f.message}`)}F(f=>f.map(o=>o.id===z.id?{...o,...t,updated_at:new Date().toISOString()}:o)),x({type:"success",text:"âœ… Transaction updated successfully"}),D(null),A(null),setTimeout(()=>x({type:"",text:""}),3e3)}catch(r){console.error("[UPDATE_TRANSACTION]",r.message),x({type:"error",text:`Failed to update transaction: ${r.message}`})}finally{w(!1)}},_e=async()=>{w(!0);try{const t=W,r=M(t.transaction_type),m=B(t.transaction_type);if(!r&&m){const{data:f}=await b.from("accounts").select("*").eq("is_deleted",!1),o=f.find(l=>l.id===t.from_account_id);if(o&&o.balance<t.amount)throw new Error(`Insufficient funds. Available: ${o.currency} ${o.balance.toFixed(2)}, Required: ${t.currency} ${t.amount.toFixed(2)}`)}const T=new Date().toISOString(),{error:S}=await b.from("transactions").update({status:"completed",approved_at:T,completed_at:T,updated_at:T}).eq("id",t.id);if(S)throw S;if(!r)try{await Y({...t,status:"completed"})}catch(f){throw await b.from("transactions").update({status:"pending",approved_at:null,completed_at:null,updated_at:new Date().toISOString()}).eq("id",t.id),new Error(`Balance update failed: ${f.message}`)}F(f=>f.map(o=>o.id===t.id?{...o,status:"completed",approved_at:T,completed_at:T,updated_at:T}:o)),x({type:"success",text:`âœ… Transaction approved! ${r?"(Loan - balance unchanged)":"(Balance updated)"}`}),P(null),setTimeout(()=>x({type:"",text:""}),4e3)}catch(t){console.error("[APPROVE_TRANSACTION]",t.message),x({type:"error",text:`Failed to approve transaction: ${t.message}`})}finally{w(!1)}},je=async()=>{w(!0);try{const{error:t}=await b.from("transactions").update({status:"failed",failure_reason:"Rejected by admin during approval",updated_at:new Date().toISOString()}).eq("id",W.id);if(t)throw t;F(r=>r.map(m=>m.id===W.id?{...m,status:"failed",failure_reason:"Rejected by admin during approval",updated_at:new Date().toISOString()}:m)),x({type:"success",text:"âœ… Transaction rejected successfully"}),P(null),setTimeout(()=>x({type:"",text:""}),3e3)}catch(t){console.error("[REJECT_TRANSACTION]",t.message),x({type:"error",text:`Failed to reject transaction: ${t.message}`})}finally{w(!1)}},ve=async()=>{w(!0);try{const t=J;t.status==="completed"&&await ce(t);const{error:r}=await b.from("transactions").delete().eq("id",t.id);if(r)throw r;F(m=>m.filter(T=>T.id!==t.id)),x({type:"success",text:"âœ… Transaction deleted and balance reversed"}),G(null),setTimeout(()=>x({type:"",text:""}),3e3)}catch(t){console.error("[DELETE_TRANSACTION]",t.message),x({type:"error",text:`Failed to delete transaction: ${t.message}`})}finally{w(!1)}},K=L.filter(t=>{const r=t.reference_number?.toLowerCase().includes(I.toLowerCase())||t.description?.toLowerCase().includes(I.toLowerCase())||t.amount?.toString().includes(I),m=O==="all"||t.status===O;return r&&m}),oe=t=>g.find(m=>m.id===t)?.account_number||"Unknown",ie=t=>t?new Date(t).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"â€”";return n?e.jsxs("div",{className:"min-h-screen bg-primary",children:[e.jsx(Se,{adminEmail:u,onMenuToggle:()=>a(!i)}),e.jsxs("div",{className:"flex",children:[e.jsx(Ce,{isOpen:i,onClose:()=>a(!1)}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"container mx-auto max-w-7xl px-4 sm:px-6 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-secondary mb-2",children:"ðŸ’³ Transaction Management"}),e.jsx("p",{className:"text-sm text-secondary opacity-70",children:"Create, edit, approve, and manage all transactions with full timestamp control and balance validation"})]}),j.text&&e.jsx("div",{className:`mb-6 p-4 rounded-sm border-l-4 ${j.type==="success"?"bg-green-50 border-green-500 text-green-800":"bg-red-50 border-red-500 text-red-800"}`,children:e.jsx("p",{className:"text-sm font-semibold",children:j.text})}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 items-stretch sm:items-center justify-between",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-secondary opacity-60",children:e.jsx(ke,{})}),e.jsx("input",{type:"text",placeholder:"Search by reference, description, or amount...",value:I,onChange:t=>R(t.target.value),className:"w-full pl-12 pr-4 py-3 border border-secondary rounded-sm focus:outline-none focus:ring-2 focus:ring-basic focus:ring-opacity-30 text-sm"})]}),e.jsxs("select",{value:O,onChange:t=>c(t.target.value),className:"px-4 py-3 border border-secondary rounded-sm focus:outline-none focus:ring-2 focus:ring-basic focus:ring-opacity-30 text-sm bg-primary",children:[e.jsx("option",{value:"all",children:"All Transactions"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"reversed",children:"Reversed"}),e.jsx("option",{value:"on_hold",children:"On Hold"})]}),e.jsxs("button",{onClick:()=>k(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 transition-all whitespace-nowrap",children:[e.jsx(me,{})," Create Transaction"]})]}),N?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(U,{size:"lg"})}):K.length===0?e.jsx("div",{className:"bg-primary border border-secondary rounded-sm p-12 text-center",children:e.jsx("p",{className:"text-secondary opacity-70",children:"No transactions found"})}):e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm shadow-md overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-secondary bg-opacity-5 border-b border-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary uppercase tracking-wider",children:"Reference"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary uppercase tracking-wider",children:"From Account"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-secondary uppercase tracking-wider",children:"Approved"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-secondary uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-secondary",children:K.map(t=>e.jsxs("tr",{className:"hover:bg-secondary hover:bg-opacity-5 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>A(t),className:"font-mono text-sm text-basic font-semibold hover:underline cursor-pointer",children:t.reference_number})}),e.jsx("td",{className:"px-6 py-4 text-sm text-secondary opacity-70",children:oe(t.from_account_id)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"font-semibold text-basic",children:[t.currency," ",t.amount.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-secondary opacity-70",children:e.jsx("span",{className:"capitalize",children:t.transaction_type.replace(/_/g," ")})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold ${t.status==="completed"?"bg-green-100 text-green-800":t.status==="pending"?"bg-yellow-100 text-yellow-800":t.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[t.status==="completed"&&e.jsx(xe,{}),t.status==="failed"&&e.jsx(be,{}),t.status.charAt(0).toUpperCase()+t.status.slice(1)]})}),e.jsx("td",{className:"px-6 py-4 text-xs text-secondary opacity-70",children:ie(t.created_at)}),e.jsx("td",{className:"px-6 py-4 text-xs text-secondary opacity-70",children:ie(t.approved_at)}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>A(t),className:"p-2 hover:bg-basic hover:bg-opacity-10 rounded-sm transition-all",title:"View transaction details",children:e.jsx(le,{})}),t.status==="pending"&&e.jsx("button",{onClick:()=>P(t),className:"p-2 hover:bg-green-100 rounded-sm transition-all text-green-600",title:"Approve transaction",children:e.jsx(re,{})}),e.jsx("button",{onClick:()=>D(t),className:"p-2 hover:bg-basic hover:bg-opacity-10 rounded-sm transition-all",title:"Edit transaction details",children:e.jsx(X,{})}),e.jsx("button",{onClick:()=>G(t),className:"p-2 hover:bg-red-500 hover:bg-opacity-10 rounded-sm transition-all text-red-600",title:"Delete transaction",children:e.jsx(se,{})})]})})]},t.id))})]})}),e.jsx("div",{className:"md:hidden divide-y divide-secondary",children:K.map(t=>e.jsxs("div",{className:"p-4 hover:bg-secondary hover:bg-opacity-5 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>A(t),children:[e.jsx("p",{className:"font-mono font-semibold text-basic text-sm hover:underline",children:t.reference_number}),e.jsx("p",{className:"text-xs text-secondary opacity-60 mt-1",children:t.description||"No description"})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold whitespace-nowrap ml-2 ${t.status==="completed"?"bg-green-100 text-green-800":t.status==="pending"?"bg-yellow-100 text-yellow-800":t.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary opacity-60",children:"Amount"}),e.jsxs("p",{className:"font-semibold text-basic",children:[t.currency," ",t.amount.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary opacity-60",children:"Type"}),e.jsx("p",{className:"font-semibold text-secondary capitalize",children:t.transaction_type.replace(/_/g," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary opacity-60",children:"From"}),e.jsx("p",{className:"font-semibold text-secondary",children:oe(t.from_account_id)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary opacity-60",children:"Created"}),e.jsx("p",{className:"font-semibold text-secondary",children:new Date(t.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-secondary",children:[e.jsxs("button",{onClick:()=>A(t),className:"flex-1 py-2 px-3 text-xs font-semibold border border-secondary text-secondary rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all flex items-center justify-center gap-1",children:[e.jsx(le,{})," View"]}),t.status==="pending"&&e.jsxs("button",{onClick:()=>P(t),className:"flex-1 py-2 px-3 text-xs font-semibold bg-green-100 text-green-600 rounded-sm hover:bg-green-200 transition-all flex items-center justify-center gap-1",children:[e.jsx(re,{})," Approve"]}),e.jsxs("button",{onClick:()=>D(t),className:"flex-1 py-2 px-3 text-xs font-semibold border border-secondary text-secondary rounded-sm hover:bg-secondary hover:bg-opacity-5 transition-all flex items-center justify-center gap-1",children:[e.jsx(X,{})," Edit"]}),e.jsxs("button",{onClick:()=>G(t),className:"flex-1 py-2 px-3 text-xs font-semibold bg-red-100 text-red-600 rounded-sm hover:bg-red-200 transition-all flex items-center justify-center gap-1",children:[e.jsx(se,{})," Delete"]})]})]},t.id))})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-4 text-center",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 mb-2 uppercase tracking-wider font-semibold",children:"Total Transactions"}),e.jsx("p",{className:"text-3xl font-bold text-basic",children:L.length})]}),e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-4 text-center",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 mb-2 uppercase tracking-wider font-semibold",children:"Pending Approval"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:L.filter(t=>t.status==="pending").length})]}),e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-4 text-center",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 mb-2 uppercase tracking-wider font-semibold",children:"Completed"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:L.filter(t=>t.status==="completed").length})]}),e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-4 text-center",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 mb-2 uppercase tracking-wider font-semibold",children:"Failed"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:L.filter(t=>t.status==="failed").length})]}),e.jsxs("div",{className:"bg-primary border border-secondary rounded-sm p-4 text-center",children:[e.jsx("p",{className:"text-xs text-secondary opacity-60 mb-2 uppercase tracking-wider font-semibold",children:"Total Amount"}),e.jsx("p",{className:"text-xl font-bold text-basic",children:L.reduce((t,r)=>t+(r.amount||0),0).toLocaleString("en-US",{style:"currency",currency:"USD"})})]})]})]})})]}),q&&e.jsx(ue,{mode:"create",transaction:null,accounts:g,onClose:()=>k(!1),onSubmit:fe,submitting:C}),E&&e.jsx(Ee,{transaction:E,accounts:g,onClose:()=>A(null),onEditClick:()=>{A(null),D(E)}}),z&&e.jsx(ue,{mode:"edit",transaction:z,accounts:g,onClose:()=>D(null),onSubmit:ge,submitting:C}),W&&e.jsx(Le,{transaction:W,accounts:g,onApprove:_e,onReject:je,onCancel:()=>P(null),submitting:C}),J&&e.jsx($e,{transaction:J,onConfirm:ve,onCancel:()=>G(null),submitting:C})]}):e.jsx("div",{className:"min-h-screen bg-primary flex items-center justify-center",children:e.jsx(U,{size:"lg"})})};export{qe as default};
