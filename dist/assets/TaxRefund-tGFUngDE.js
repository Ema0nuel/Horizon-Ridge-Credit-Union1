import{u as P,r as d,s as S,j as e,a as E}from"./index-nw5vX4eR.js";import{U as G}from"./UserHeader-LSGpS8F-.js";import{h as K}from"./authService-BzjFe2h-.js";import"./api-CBahbCmN.js";const V=()=>e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),X=()=>e.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),J=()=>e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),Q=()=>e.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})}),q=()=>e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),Z=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),F=({label:l,name:n,type:h="text",value:r,onChange:g,placeholder:f,required:y=!1,error:p,disabled:c=!1,helpText:x})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:[l,y&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsx("input",{type:h,name:n,value:r,onChange:g,placeholder:f,disabled:c,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans ${p?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${c?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`}),p&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:p}),x&&!p&&e.jsx("p",{className:"text-xs text-secondary opacity-60 mt-1",children:x})]}),_=({label:l,name:n,value:h,onChange:r,options:g,required:f=!1,error:y,disabled:p=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:[l,f&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsxs("select",{name:n,value:h,onChange:r,disabled:p,className:`w-full px-4 py-3 border rounded-sm focus:outline-none focus:ring-2 transition-all font-sans ${y?"border-red-500 focus:ring-red-500 focus:ring-opacity-50":"border-secondary focus:ring-basic focus:ring-opacity-30"} ${p?"bg-gray-100 opacity-50 cursor-not-allowed":"bg-primary"}`,children:[e.jsxs("option",{value:"",children:["Select ",l.toLowerCase()]}),g.map(c=>e.jsx("option",{value:c.id||c.value,children:c.label},c.id||c.value))]}),y&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:y})]}),ee=({isOpen:l,transaction:n,account:h,profile:r,onClose:g,onDownload:f})=>{if(!l||!n)return null;const y=(p,c)=>`${c} ${parseFloat(p).toFixed(2)}`;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-basic text-primary p-6 text-center",children:[e.jsx("div",{className:"text-5xl mb-3",children:"ðŸ“‹"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Tax Refund Request"}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Application Receipt"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"text-center py-4 rounded-sm border-l-4 border-yellow-500 bg-yellow-50",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(Q,{}),e.jsx("p",{className:"font-bold text-yellow-800",children:"Processing"})]}),e.jsx("p",{className:"text-xs text-yellow-700",children:"Awaiting admin approval & verification"})]}),e.jsxs("div",{className:"space-y-2 text-sm border-b border-secondary pb-4",children:[e.jsx("p",{className:"text-secondary opacity-70 text-xs uppercase tracking-wider font-semibold",children:"Reference Number"}),e.jsx("p",{className:"font-mono font-bold text-secondary text-base break-all",children:n.reference_number})]}),e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-xs text-secondary opacity-70 mb-1 uppercase tracking-wider font-semibold",children:"Refund Amount"}),e.jsx("p",{className:"text-3xl font-bold text-basic",children:y(n.amount,n.currency)})]}),e.jsxs("div",{className:"space-y-3 text-sm border-y border-secondary py-4",children:[n.metadata?.tax_year&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Tax Year:"}),e.jsx("span",{className:"font-semibold text-secondary",children:n.metadata.tax_year})]}),n.metadata?.filing_status&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Filing Status:"}),e.jsx("span",{className:"font-semibold text-secondary capitalize",children:n.metadata.filing_status})]}),n.metadata?.employment_status&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Employment:"}),e.jsx("span",{className:"font-semibold text-secondary capitalize",children:n.metadata.employment_status})]})]}),e.jsxs("div",{className:"space-y-2 text-sm border-b border-secondary pb-4",children:[e.jsx("p",{className:"text-secondary opacity-70 text-xs uppercase tracking-wider font-semibold",children:"Refund Destination"}),e.jsx("p",{className:"font-semibold text-secondary",children:h?.account_number}),e.jsx("p",{className:"text-xs text-secondary opacity-70",children:r?.full_name})]}),e.jsxs("div",{className:"space-y-3 text-xs text-secondary opacity-70",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Submitted:"}),e.jsx("span",{children:new Date(n.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Time:"}),e.jsx("span",{children:new Date(n.created_at).toLocaleTimeString()})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-sm border border-blue-200 p-4 text-xs text-blue-900",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(q,{}),e.jsx("strong",{children:"What Happens Next:"})]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Admin verification of documents"}),e.jsx("li",{children:"Tax authority comparison & calculation"}),e.jsx("li",{children:"Approval decision (5-10 business days)"}),e.jsx("li",{children:"Funds credited to your account"})]})]}),e.jsxs("div",{className:"bg-orange-50 rounded-sm border border-orange-200 p-3 text-xs text-orange-900 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"âš ï¸ Important Notes:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 ml-1",children:[e.jsx("li",{children:"Do not close this page until admin approval"}),e.jsx("li",{children:"Keep your reference number for tracking"}),e.jsx("li",{children:"Contact support if you have questions"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 border-t border-secondary space-y-3",children:[e.jsxs("button",{onClick:f,className:"w-full py-2 px-4 border border-secondary text-secondary font-semibold rounded-sm hover:bg-primary transition-all active:scale-95 flex items-center justify-center gap-2 text-sm",children:[e.jsx(Z,{}),"Download Receipt"]}),e.jsx("button",{onClick:g,className:"w-full py-2 px-4 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 transition-all active:scale-95",children:"Close"})]})]})})},se=({currentStep:l,steps:n})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex justify-between items-center",children:n.map((h,r)=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center font-bold text-xs sm:text-sm transition-all ${r<l?"bg-green-500 text-white":r===l?"bg-basic text-primary":"bg-gray-200 text-gray-600"}`,children:r<l?"✔️":r+1}),r<n.length-1&&e.jsx("div",{className:`flex-1 h-1 mx-2 sm:mx-4 transition-all ${r<l?"bg-green-500":"bg-gray-200"}`})]},r))}),e.jsx("div",{className:"flex justify-between mt-2 text-xs sm:text-sm",children:n.map((h,r)=>e.jsx("span",{className:`font-semibold ${r===l?"text-basic":r<l?"text-green-600":"text-secondary opacity-50"}`,children:h},r))})]});function le(){const l=P(),[n,h]=d.useState(null),[r,g]=d.useState(null),[f,y]=d.useState([]),[p,c]=d.useState(!0),[x,R]=d.useState(0),[s,w]=d.useState({accountId:"",taxYear:new Date().getFullYear()-1,filingStatus:"single",employmentStatus:"employed",grossIncome:"",taxWithheld:"",taxOwed:"",refundAmount:"",taxReturnFiledDate:"",description:""}),[b,C]=d.useState({}),[A,v]=d.useState({type:"",text:""}),[O,$]=d.useState(!1),[m,z]=d.useState(null),[D,k]=d.useState(!1),I=["Review Info","Tax Details","Calculation","Confirm"];d.useEffect(()=>{let a=!0;return(async()=>{try{const{data:{session:t}={}}=await S.auth.getSession(),i=t?.user?.id;if(!i){l("/auth/login",{replace:!0});return}h(i);const{data:u}=await S.from("user_profiles").select("*").eq("id",i).eq("is_deleted",!1).maybeSingle(),{data:N}=await S.from("accounts").select("*").eq("user_id",i).eq("is_deleted",!1).order("created_at",{ascending:!1});a&&(g(u),y(N||[]),N?.length>0&&w(T=>({...T,accountId:N[0].id})))}catch(t){console.error("[TAX_REFUND] Load error:",t),v({type:"error",text:"Failed to load account data"})}finally{a&&c(!1)}})(),()=>{a=!1}},[l]);const j=a=>{const{name:t,value:i}=a.target;w(u=>({...u,[t]:i})),b[t]&&C(u=>({...u,[t]:""}))};d.useEffect(()=>{if(s.taxWithheld&&s.taxOwed){const a=parseFloat(s.taxWithheld)||0,t=parseFloat(s.taxOwed)||0,i=Math.max(0,a-t);w(u=>({...u,refundAmount:i.toFixed(2)}))}},[s.taxWithheld,s.taxOwed]);const W=a=>{const t={};return a===0&&(s.accountId||(t.accountId="Select destination account")),a===1&&(s.taxYear||(t.taxYear="Select tax year"),s.filingStatus||(t.filingStatus="Select filing status"),s.employmentStatus||(t.employmentStatus="Select employment status"),s.taxReturnFiledDate||(t.taxReturnFiledDate="Enter date filed")),a===2&&((!s.grossIncome||parseFloat(s.grossIncome)<=0)&&(t.grossIncome="Enter valid gross income"),(!s.taxWithheld||parseFloat(s.taxWithheld)<0)&&(t.taxWithheld="Enter valid tax withheld"),(!s.taxOwed||parseFloat(s.taxOwed)<0)&&(t.taxOwed="Enter valid tax owed"),(!s.refundAmount||parseFloat(s.refundAmount)<=0)&&(t.refundAmount="Refund amount must be greater than 0")),a===3&&(s.description||(t.description="Provide description")),C(t),Object.keys(t).length===0},Y=()=>{W(x)&&(R(a=>Math.min(a+1,I.length-1)),v({type:"",text:""}))},L=()=>{R(a=>Math.max(a-1,0)),v({type:"",text:""})},M=async a=>{if(a.preventDefault(),!!W(x)){$(!0),v({type:"",text:""});try{const t=f.find(T=>T.id===s.accountId),i=parseFloat(s.refundAmount),{data:u,error:N}=await S.from("transactions").insert([{from_account_id:s.accountId,amount:i,currency:t?.currency||"EUR",transaction_type:"tax_refund",status:"pending",description:s.description,reference_number:`TR-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,initiated_by_user_id:n,metadata:{tax_year:s.taxYear,filing_status:s.filingStatus,employment_status:s.employmentStatus,gross_income:s.grossIncome,tax_withheld:s.taxWithheld,tax_owed:s.taxOwed,refund_amount:i,tax_return_filed_date:s.taxReturnFiledDate,workflow_stage:"submitted",submitted_at:new Date().toISOString()}}]).select("*").single();if(N)throw N;z(u),k(!0),v({type:"success",text:`Tax refund request submitted! Reference: ${u.reference_number}`})}catch(t){console.error("[TAX_REFUND] Submission error:",t),v({type:"error",text:t.message||"Failed to submit tax refund request"})}finally{$(!1)}}},B=()=>{if(!m)return;const a=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Tax Refund Receipt</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
          .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .header { text-align: center; border-bottom: 2px solid #1b9466b9; padding-bottom: 20px; margin-bottom: 30px; }
          .header h1 { margin: 0; color: #1b9466b9; font-size: 24px; }
          .header p { margin: 5px 0 0 0; color: #666; }
          .section { margin-bottom: 25px; }
          .section-title { font-weight: bold; color: #1b1b1b; font-size: 14px; text-transform: uppercase; margin-bottom: 10px; }
          .field { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
          .field-label { color: #666; }
          .field-value { font-weight: bold; color: #1b1b1b; }
          .amount-box { background: #f0f8f0; padding: 15px; border-radius: 5px; text-align: center; margin: 20px 0; }
          .amount-label { color: #666; font-size: 12px; }
          .amount-value { font-size: 32px; font-weight: bold; color: #1b9466b9; }
          .status { background: #fff3cd; padding: 15px; border-left: 4px solid #ffc107; margin: 20px 0; border-radius: 3px; }
          .footer { text-align: center; color: #999; font-size: 12px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>ðŸ“‹ Tax Refund Request Receipt</h1>
            <p>Horizon Ridge Credit Union Bank</p>
          </div>

          <div class="section">
            <div class="section-title">Request Status</div>
            <div class="status">
              <strong>Processing</strong><br>
              <small>Awaiting admin approval & verification</small>
            </div>
          </div>

          <div class="section">
            <div class="section-title">Request Details</div>
            <div class="field">
              <span class="field-label">Reference Number:</span>
              <span class="field-value">${m.reference_number}</span>
            </div>
            <div class="field">
              <span class="field-label">Submitted Date:</span>
              <span class="field-value">${new Date(m.created_at).toLocaleDateString()}</span>
            </div>
          </div>

          <div class="amount-box">
            <div class="amount-label">Refund Amount</div>
            <div class="amount-value">${m.currency} ${parseFloat(m.amount).toFixed(2)}</div>
          </div>

          <div class="section">
            <div class="section-title">Tax Information</div>
            <div class="field">
              <span class="field-label">Tax Year:</span>
              <span class="field-value">${m.metadata?.tax_year||"N/A"}</span>
            </div>
            <div class="field">
              <span class="field-label">Filing Status:</span>
              <span class="field-value">${m.metadata?.filing_status||"N/A"}</span>
            </div>
            <div class="field">
              <span class="field-label">Gross Income:</span>
              <span class="field-value">${m.metadata?.gross_income||"N/A"}</span>
            </div>
            <div class="field">
              <span class="field-label">Tax Withheld:</span>
              <span class="field-value">${m.metadata?.tax_withheld||"N/A"}</span>
            </div>
            <div class="field">
              <span class="field-label">Tax Owed:</span>
              <span class="field-value">${m.metadata?.tax_owed||"N/A"}</span>
            </div>
          </div>

          <div class="section">
            <div class="section-title">What Happens Next</div>
            <ol style="color: #666; line-height: 1.8;">
              <li>Bank reports your request to tax authority</li>
              <li>System verifies documents & calculations</li>
              <li>Approval decision (5-10 business days)</li>
              <li>Funds credited to your account</li>
            </ol>
          </div>

          <div class="footer">
            <p>Thank you for banking with Horizon Ridge Credit Union</p>
            <p>Keep this receipt for your records</p>
          </div>
        </div>
      </body>
      </html>
    `,t=new Blob([a],{type:"text/html;charset=utf-8"}),i=document.createElement("a"),u=URL.createObjectURL(t);i.setAttribute("href",u),i.setAttribute("download",`tax-refund-receipt-${m.reference_number}.html`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)},U=()=>{R(0),w({accountId:f[0]?.id||"",taxYear:new Date().getFullYear()-1,filingStatus:"single",employmentStatus:"employed",grossIncome:"",taxWithheld:"",taxOwed:"",refundAmount:"",taxReturnFiledDate:"",description:""}),C({}),v({type:"",text:""}),z(null),k(!1)};if(p)return e.jsx("div",{className:"min-h-screen bg-primary flex items-center justify-center",children:e.jsx(E,{size:"lg"})});if(!n)return null;const o=f.find(a=>a.id===s.accountId),H=f.map(a=>({id:a.id,label:`${a.account_number} (${a.account_type}) - ${a.currency}`}));return e.jsxs("div",{className:"min-h-screen bg-primary",children:[e.jsx(G,{profile:r,handleSignOut:()=>K(l)}),e.jsxs("main",{className:"container mx-auto max-w-4xl px-4 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-2 text-xs sm:text-sm text-secondary opacity-70",children:[e.jsx("button",{onClick:()=>l("/dashboard"),className:"hover:opacity-100 font-bold",children:"< Dashboard"}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"font-semibold opacity-100",children:"Tax Refund"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(V,{}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-secondary",children:"Request Tax Refund"})]}),e.jsx("p",{className:"text-sm sm:text-base text-secondary opacity-70",children:"File your tax refund request with Horizon Ridge Credit Union. We'll report to the tax authority and credit your account upon approval."})]}),A.text&&e.jsx("div",{className:`mb-6 p-4 sm:p-6 rounded-sm border-l-4 ${A.type==="success"?"bg-green-50 border-green-500 text-green-800":"bg-red-50 border-red-500 text-red-800"}`,children:e.jsx("p",{className:"text-sm font-semibold",children:A.text})}),!D&&e.jsx(se,{currentStep:x,steps:I}),D?null:e.jsx("div",{className:"bg-primary rounded-sm border border-secondary shadow-md p-6 sm:p-8",children:e.jsxs("form",{onSubmit:M,children:[x===0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-secondary mb-6",children:"Account Information"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-sm p-4 mb-6 flex gap-3",children:[e.jsx(q,{}),e.jsxs("div",{className:"text-sm text-blue-900",children:[e.jsx("p",{className:"font-semibold mb-1",children:"About This Process:"}),e.jsx("p",{children:"Bank reports withheld tax to authority â†’ System compares tax paid vs. owed â†’ Refund is calculated â†’ Authority approves â†’ Funds credited to your account"})]})]}),e.jsx(_,{label:"Refund Destination Account",name:"accountId",value:s.accountId,onChange:j,options:H,required:!0,error:b.accountId}),o&&e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary p-6 space-y-4",children:[e.jsx("h3",{className:"font-bold text-secondary text-base",children:"Selected Account Details"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Account Number:"}),e.jsx("span",{className:"font-semibold text-secondary",children:o.account_number})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Account Type:"}),e.jsx("span",{className:"font-semibold text-secondary capitalize",children:o.account_type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Currency:"}),e.jsx("span",{className:"font-semibold text-secondary",children:o.currency})]}),e.jsxs("div",{className:"flex justify-between pt-3 border-t border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Current Balance:"}),e.jsxs("span",{className:"font-bold text-basic",children:[o.currency," ",parseFloat(o.balance||0).toFixed(2)]})]})]})]})]}),x===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-secondary mb-6",children:"Tax Year & Filing Details"}),e.jsx(_,{label:"Tax Year",name:"taxYear",value:s.taxYear,onChange:j,options:Array.from({length:5},(a,t)=>({id:new Date().getFullYear()-t-1,label:new Date().getFullYear()-t-1})),required:!0,error:b.taxYear}),e.jsx(_,{label:"Filing Status",name:"filingStatus",value:s.filingStatus,onChange:j,options:[{id:"single",label:"Single"},{id:"married",label:"Married Filing Jointly"},{id:"married_sep",label:"Married Filing Separately"},{id:"head_household",label:"Head of Household"}],required:!0,error:b.filingStatus}),e.jsx(_,{label:"Employment Status",name:"employmentStatus",value:s.employmentStatus,onChange:j,options:[{id:"employed",label:"Employed"},{id:"self_employed",label:"Self-Employed"},{id:"retired",label:"Retired"},{id:"student",label:"Student"}],required:!0,error:b.employmentStatus}),e.jsx(F,{label:"Tax Return Filed Date",name:"taxReturnFiledDate",type:"date",value:s.taxReturnFiledDate,onChange:j,required:!0,error:b.taxReturnFiledDate})]}),x===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-secondary mb-6",children:"Tax Calculation"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-sm p-4 flex gap-3 mb-6",children:[e.jsx(q,{}),e.jsx("p",{className:"text-sm text-blue-900",children:"The system compares your withheld taxes against what you actually owe to calculate your refund amount."})]}),e.jsx(F,{label:"Gross Annual Income",name:"grossIncome",type:"number",step:"0.01",value:s.grossIncome,onChange:j,placeholder:"0.00",required:!0,error:b.grossIncome}),e.jsx(F,{label:"Total Tax Withheld (by employer)",name:"taxWithheld",type:"number",step:"0.01",value:s.taxWithheld,onChange:j,placeholder:"0.00",required:!0,error:b.taxWithheld}),e.jsx(F,{label:"Total Tax Owed (based on return)",name:"taxOwed",type:"number",step:"0.01",value:s.taxOwed,onChange:j,placeholder:"0.00",required:!0,error:b.taxOwed}),s.taxWithheld&&s.taxOwed&&e.jsxs("div",{className:"bg-primary rounded-sm border border-basic shadow-lg p-6",children:[e.jsx("h3",{className:"font-bold text-secondary text-base mb-4",children:"Refund Calculation"}),e.jsxs("div",{className:"space-y-3 text-sm mb-4",children:[e.jsxs("div",{className:"flex justify-between pb-2 border-b border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Tax Withheld:"}),e.jsxs("span",{className:"font-semibold text-secondary",children:[o?.currency," ",parseFloat(s.taxWithheld).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between pb-2 border-b border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Tax Owed:"}),e.jsxs("span",{className:"font-semibold text-secondary",children:[o?.currency," ",parseFloat(s.taxOwed).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between pt-4 text-lg",children:[e.jsx("span",{className:"font-bold text-secondary",children:"Refund Amount:"}),e.jsxs("span",{className:"font-bold text-basic text-2xl",children:[o?.currency," ",parseFloat(s.refundAmount||0).toFixed(2)]})]})]})]}),x===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-secondary mb-6",children:"Confirm & Submit"}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-sm p-4 flex gap-3 mb-6",children:[e.jsx(J,{}),e.jsxs("p",{className:"text-sm text-yellow-900",children:[e.jsx("strong",{children:"Important:"})," By submitting this request, I confirm that all information provided is accurate and complete. This request is subject to admin verification and tax authority approval."]})]}),e.jsxs("div",{className:"bg-primary rounded-sm border border-secondary p-6 space-y-4 mb-6",children:[e.jsx("h3",{className:"font-bold text-secondary text-base",children:"Request Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between pb-2 border-b border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Account:"}),e.jsx("span",{className:"font-semibold text-secondary",children:o?.account_number})]}),e.jsxs("div",{className:"flex justify-between pb-2 border-b border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Tax Year:"}),e.jsx("span",{className:"font-semibold text-secondary",children:s.taxYear})]}),e.jsxs("div",{className:"flex justify-between pb-2 border-b border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Gross Income:"}),e.jsxs("span",{className:"font-semibold text-secondary",children:[o?.currency," ",parseFloat(s.grossIncome).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between pb-2 border-b border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Tax Withheld:"}),e.jsxs("span",{className:"font-semibold text-secondary",children:[o?.currency," ",parseFloat(s.taxWithheld).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between pb-2 border-b border-secondary",children:[e.jsx("span",{className:"text-secondary opacity-70",children:"Tax Owed:"}),e.jsxs("span",{className:"font-semibold text-secondary",children:[o?.currency," ",parseFloat(s.taxOwed).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between pt-4 text-lg font-bold",children:[e.jsx("span",{className:"text-secondary",children:"Refund Amount:"}),e.jsxs("span",{className:"text-basic text-2xl",children:[o?.currency," ",parseFloat(s.refundAmount||0).toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-secondary mb-2 uppercase tracking-wider opacity-80",children:"Additional Notes (Optional)"}),e.jsx("textarea",{name:"description",value:s.description,onChange:j,placeholder:"Enter any additional information...",rows:"4",className:"w-full px-4 py-3 border border-secondary rounded-sm focus:outline-none focus:ring-2 focus:ring-basic focus:ring-opacity-30 font-sans bg-primary"}),b.description&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:b.description})]})]}),e.jsxs("div",{className:"flex gap-3 mt-8 pt-6 border-t border-secondary",children:[e.jsx("button",{type:"button",onClick:L,disabled:x===0,className:"flex-1 py-3 px-6 border border-secondary text-secondary font-semibold rounded-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:"Back"}),x<I.length-1?e.jsx("button",{type:"button",onClick:Y,className:"flex-1 py-3 px-6 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 transition-all active:scale-95",children:"Continue"}):e.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-3 px-6 bg-green-600 text-white font-bold rounded-sm hover:bg-green-700 disabled:opacity-50 transition-all active:scale-95 flex items-center justify-center gap-2",children:O?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:"sm"})," Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{})," Submit Request"]})})]})]})})]}),e.jsx(ee,{isOpen:D,transaction:m,account:o,profile:r,onClose:()=>{k(!1),setTimeout(()=>{U(),l("/dashboard")},2e3)},onDownload:B})]})}export{le as TaxRefundPage,le as default};
