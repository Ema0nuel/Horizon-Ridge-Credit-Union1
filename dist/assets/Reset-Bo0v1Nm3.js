import{u as N,c as v,r as s,j as e,a as x,s as P}from"./index-nw5vX4eR.js";import{a as k}from"./useAuth-CEWmmymt.js";import"./authService-BzjFe2h-.js";import"./api-CBahbCmN.js";function C(){const u=N(),{updatePassword:p,loading:t}=k(),{token:c}=v(),[n,b]=s.useState(""),[d,h]=s.useState(""),[m,o]=s.useState(""),[f,y]=s.useState(!1),[g,i]=s.useState(!1),[w,l]=s.useState(!0);s.useEffect(()=>{(async()=>{l(!0);try{if(c){i(!0),l(!1);return}const{data:a}=await P.auth.getSession();a?.session?i(!0):i(!1)}catch(a){console.error("[RESET] Token validation error:",a),i(!1)}finally{l(!1)}})()},[c]);const j=async r=>{if(r.preventDefault(),o(""),!n||!d){o("Please fill in all fields");return}if(n!==d){o("Passwords do not match");return}if(n.length<8){o("Password must be at least 8 characters");return}try{await p(n),y(!0),setTimeout(()=>u("/auth/login"),2e3)}catch(a){console.error("[RESET] Password update error:",a),o(a.message||"Failed to reset password")}};return w?e.jsx("div",{className:"min-h-screen bg-primary flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-md bg-primary rounded-sm border border-secondary shadow-lg p-8 text-center",children:[e.jsx(x,{size:"lg"}),e.jsx("p",{className:"text-sm text-secondary opacity-70 mt-4",children:"Validating reset link..."})]})}):g?e.jsx("div",{className:"min-h-screen bg-primary flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-md bg-primary rounded-sm border border-secondary shadow-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-secondary mb-2",children:"Create New Password"}),e.jsx("p",{className:"text-sm text-secondary opacity-70",children:"Enter a strong password for your account"})]}),f?e.jsxs("div",{className:"p-6 bg-green-100 border border-green-300 rounded-sm text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"✓"}),e.jsx("h2",{className:"font-semibold text-green-800 mb-2",children:"Success!"}),e.jsx("p",{className:"text-sm text-green-700",children:"Your password has been reset. Redirecting to login..."})]}):e.jsxs("form",{onSubmit:j,className:"space-y-6",noValidate:!0,children:[m&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-300 text-red-800 rounded-sm text-sm flex items-start gap-3",role:"alert",children:[e.jsx("span",{className:"text-lg",children:"⚠"}),e.jsx("span",{children:m})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary mb-2",children:["New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"password",type:"password",value:n,onChange:r=>b(r.target.value),placeholder:"Min 8 characters",className:"w-full px-4 py-3 border border-secondary rounded-sm text-secondary bg-primary focus:outline-none focus:ring-2 focus:ring-basic focus:border-transparent transition-all",disabled:t,required:!0,"aria-describedby":"password-hint"}),e.jsx("p",{id:"password-hint",className:"text-xs text-secondary opacity-60 mt-1",children:"Use uppercase, lowercase, numbers, and symbols for strength"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-secondary mb-2",children:["Confirm Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"confirmPassword",type:"password",value:d,onChange:r=>h(r.target.value),placeholder:"Re-enter password",className:"w-full px-4 py-3 border border-secondary rounded-sm text-secondary bg-primary focus:outline-none focus:ring-2 focus:ring-basic focus:border-transparent transition-all",disabled:t,required:!0})]}),e.jsx("button",{type:"submit",disabled:t,className:"w-full py-3 px-4 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-all active:scale-95","aria-busy":t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(x,{size:"sm"})," Resetting..."]}):"Reset Password"})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-secondary text-center",children:e.jsxs("p",{className:"text-xs text-secondary opacity-60",children:["Remember your password?"," ",e.jsx("a",{href:"/auth/login",className:"text-basic hover:underline font-semibold",children:"Sign in here"})]})})]})}):e.jsx("div",{className:"min-h-screen bg-primary flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-md bg-primary rounded-sm border border-secondary shadow-lg p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⏰"}),e.jsx("h1",{className:"text-3xl font-bold text-secondary mb-4",children:"Invalid or Expired Link"}),e.jsx("p",{className:"text-sm text-secondary opacity-70 mb-6",children:"This reset link has expired or is invalid. Reset links are valid for 24 hours."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("a",{href:"/auth/forgot-password",className:"block w-full py-3 px-6 bg-basic text-primary font-semibold rounded-sm hover:bg-opacity-90 transition-all",children:"Request New Reset Link"}),e.jsx("a",{href:"/auth/login",className:"block w-full py-3 px-6 border border-secondary text-secondary font-semibold rounded-sm hover:bg-primary hover:bg-opacity-50 transition-all",children:"Back to Login"})]})]})})}export{C as ResetPasswordPage};
